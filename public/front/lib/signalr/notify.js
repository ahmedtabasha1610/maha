"use strict"
var myname="";var connection=new signalR.HubConnectionBuilder().withUrl("/notificationHub").configureLogging(signalR.LogLevel.Information).build();connection.start().then(function(){console.log("SignalR Connected.");if(typeof isAdmin!=='undefined')
getNotification("/Office","/Office/Notification/GetNotificationAdmin","notiContent","notificationCount");if(typeof isUser!=='undefined')
getNotification("","/Landing/GetNotificationUser","notiContentUser","notificationCountUser");if(typeof isLawyer!=='undefined')
getNotification("/LawyerDashboard","/LawyerDashboard/Notification/GetNotificationLawyer","notiContentLawyer","notificationCountLawyer");}).catch(function(e){console.log(e);});function getNotification(Distination,MethodUrl,DivClass,DivCounterClass,ClickLink){$('.'+DivClass+'').empty();$.ajax({url:MethodUrl,method:"GET",async:!1,dataType:!1,processData:!1,success:function(response){if(response.data.length==0){$('.'+DivCounterClass+'').css('display','none');$('.'+DivCounterClass+'').css('background','#fff0');if(response.lang==2){$('.'+DivClass+'').append('<a class="dropdown-item" href="#">No Notification</a>');}
else{$('.'+DivClass+'').append('<a class="dropdown-item" href="#">لا يوجد إشعارات</a>');}}else{$('.'+DivCounterClass+'').css('display','block');var Counter=0;$.each(response.data,function(index,value){if(!value.isRead){var Str='<a class="dropdown-item" onclick="MakeRead('+value.id+',\''+Distination+'\');" style="font-weight: bold;" href="'+value.clickLink+'"> '+value.text+'</a>';$('.'+DivClass+'').append($(Str));Counter=Counter+1;}
else{var Str='<a class="dropdown-item" onclick="MakeRead('+value.id+',\''+Distination+'\');" style="font-weight: normal;" href="'+value.clickLink+'"> '+value.text+'</a>';$('.'+DivClass+'').append($(Str));}});if(Counter!=0){$('.'+DivCounterClass+'').html(Counter);$('.'+DivCounterClass+'').css('background','#f44336');$('.'+DivCounterClass+'').css('color','white');}else{$('.'+DivCounterClass+'').css('background','#fff0');$('.'+DivCounterClass+'').css('display','none');}
if(response.lang==2){$('.'+DivClass+'').append($('<a class="dropdown-item showallnot" href="'+Distination+'/Notification/Index">Show All Notifications </a>'));}
else{$('.'+DivClass+'').append($('<a class="dropdown-item showallnot" href="'+Distination+'/Notification/Index">عرض كل الإشعارات </a>'));}}},error:function(error){console.log(error);}});}
connection.on('displayNotification',()=>{getNotification("/Office","/Office/Notification/GetNotificationAdmin","notiContent","notificationCount");});connection.on('displayNotificationUser',()=>{getNotification("","/Landing/GetNotificationUser","notiContentUser","notificationCountUser");});connection.on('displayNotificationLawyer',()=>{getNotification("/LawyerDashboard","/LawyerDashboard/Notification/GetNotificationLawyer","notiContentLawyer","notificationCountLawyer");});function MakeRead(Id,Distination){$.ajax({type:"GET",url:Distination+"/Notification/MakeRead?NotificationId="+Id,cache:false,success:function(data){}});}